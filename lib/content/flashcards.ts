
import { LibraryBook } from '../../types';

export const LIBRARY_BOOKS: LibraryBook[] = [
  {
    id: 'book_java',
    title: 'The Codex of Java',
    author: 'Gosling the Green',
    description: 'Learn the strict paths of Object Oriented Sorcery.',
    content: ["Java is a high-level, class-based, object-oriented programming language.", "It is designed to have as few implementation dependencies as possible.", "Write Once, Run Anywhere (WORA)."],
    rewardXp: 500,
    spellId: 'spell_java',
    questions: [
      { id: 'j1', text: 'What is JVM?', options: ['Java Virtual Machine', 'Java Visual Mode', 'Just Very Mad', 'JSON Virtual Model'], correctIndex: 0, explanation: 'The JVM executes Java bytecode, enabling cross-platform portability.', difficulty: 'Easy', xpReward: 50, topic: 'Backend & Servers' },
      { id: 'j2', text: 'What keyword makes a class not subclassable?', options: ['final', 'sealed', 'private', 'static'], correctIndex: 0, explanation: 'final on a class prevents inheritance.', difficulty: 'Medium', xpReward: 60, topic: 'OOP & Design Patterns' },
      { id: 'j3', text: 'Where are object references stored in Java?', options: ['Stack', 'Heap', 'Register', 'Cache'], correctIndex: 1, explanation: 'Objects live on the heap; local variables (references) on the stack.', difficulty: 'Medium', xpReward: 60, topic: 'General CS' },
      { id: 'j4', text: 'What is the difference between == and .equals() in Java?', options: ['No difference', '== compares references, .equals() compares values', '== compares values, .equals() compares references', '.equals() only works for primitives'], correctIndex: 1, explanation: '== tests reference identity (same object). .equals() tests value equality (overridable). Always use .equals() for strings.', difficulty: 'Medium', xpReward: 60, topic: 'Backend & Servers' },
      { id: 'j5', text: 'What does the volatile keyword do in Java?', options: ['Prevents compilation', 'Ensures visibility of variable changes across threads', 'Makes a variable immutable', 'Marks a variable for garbage collection'], correctIndex: 1, explanation: 'volatile guarantees reads/writes go directly to main memory, preventing CPU caching that can hide updates in multi-threaded code.', difficulty: 'Hard', xpReward: 90, topic: 'Concurrency' },
      { id: 'j6', text: 'What is autoboxing in Java?', options: ['A build tool', 'Automatic conversion between primitives and wrapper types (int to Integer)', 'A memory management technique', 'A Spring feature'], correctIndex: 1, explanation: 'Autoboxing: Java auto-converts int to Integer, double to Double, etc. Unboxing is the reverse. Be careful with null unboxing (NullPointerException) and performance in tight loops.', difficulty: 'Medium', xpReward: 60, topic: 'Backend & Servers' },
      { id: 'j7', text: 'What is the purpose of the synchronized keyword?', options: ['Speed up methods', 'Ensures only one thread executes a block or method at a time', 'Makes variables thread-local', 'Prevents method overriding'], correctIndex: 1, explanation: 'synchronized: mutual exclusion — only one thread holds the monitor lock at a time. Can be applied to methods or blocks. Coarse-grained; prefer java.util.concurrent for fine-grained control.', difficulty: 'Hard', xpReward: 80, topic: 'Concurrency' },
      { id: 'j8', text: 'What is a checked vs unchecked exception in Java?', options: ['Checked: thrown at runtime. Unchecked: compile-time', 'Checked: must be declared/handled at compile time. Unchecked: RuntimeException subclass, optional handling', 'No practical difference', 'Checked: by the JVM. Unchecked: by the programmer'], correctIndex: 1, explanation: 'Checked (IOException, SQLException): compiler enforces handling. Unchecked (RuntimeException subclasses like NPE, IllegalArgument): optional.', difficulty: 'Medium', xpReward: 70, topic: 'Backend & Servers' },
      { id: 'j9', text: 'What does Optional<T> solve in Java?', options: ['Performance issues', 'Explicit representation of nullable values — reduces NPE by forcing callers to handle absence', 'Thread safety', 'Immutability'], correctIndex: 1, explanation: 'Optional<T>: wraps a possibly-null value. Forces consumer to call isPresent() or map(). Makes null-returning intent explicit in APIs.', difficulty: 'Medium', xpReward: 70, topic: 'Backend & Servers' },
      { id: 'j10', text: 'What is the difference between ArrayList and LinkedList in Java?', options: ['No difference', 'ArrayList: O(1) random access, slow insert/delete in middle; LinkedList: O(n) access, O(1) insert/delete with reference', 'LinkedList is always faster', 'ArrayList only stores integers'], correctIndex: 1, explanation: 'ArrayList backed by array: fast get(i) but slow mid-list insertion. LinkedList: doubly-linked nodes, fast insertion with a node reference but poor cache locality.', difficulty: 'Medium', xpReward: 65, topic: 'Data Structures' },
      { id: 'j11', text: 'What is a Java interface default method (Java 8+)?', options: ['A method with no body', 'A method with an implementation in an interface, allowing backward-compatible API evolution', 'An abstract method', 'A static factory method'], correctIndex: 1, explanation: 'Default methods let interfaces provide a method body. Existing implementations inherit the default, enabling adding methods to interfaces without breaking all implementors.', difficulty: 'Medium', xpReward: 65, topic: 'OOP & Design Patterns' },
      { id: 'j12', text: 'What is the purpose of the transient keyword in Java?', options: ['Marks a field as thread-safe', 'Excludes a field from serialization', 'Makes a field immutable', 'Allows a field to be null'], correctIndex: 1, explanation: 'transient tells Java serialization to skip the field. Useful for caches, computed values, or sensitive data that should not be persisted.', difficulty: 'Hard', xpReward: 80, topic: 'Backend & Servers' },
    ]
  },
  {
    id: 'book_sql',
    title: 'Tablets of SQL',
    author: 'Codd the Ancient',
    description: 'Command the data of the earth with structured queries.',
    content: ["SQL stands for Structured Query Language.", "It is used to communicate with a database.", "SELECT * FROM users WHERE active = true;"],
    rewardXp: 500,
    spellId: 'spell_sql',
    questions: [
      { id: 'sq1', text: 'Which command retrieves data?', options: ['GET', 'SELECT', 'FETCH', 'PULL'], correctIndex: 1, explanation: 'SELECT is the standard SQL command for queries.', difficulty: 'Easy', xpReward: 50, topic: 'SQL & Databases' },
      { id: 'sq2', text: 'What does a JOIN do?', options: ['Combines rows from two+ tables', 'Deletes duplicates', 'Sorts results', 'Creates a backup'], correctIndex: 0, explanation: 'JOIN combines rows based on a related column.', difficulty: 'Easy', xpReward: 50, topic: 'SQL & Databases' },
      { id: 'sq3', text: 'ACID property that means "all or nothing"?', options: ['Atomicity', 'Consistency', 'Isolation', 'Durability'], correctIndex: 0, explanation: 'Atomicity: a transaction either fully commits or fully rolls back.', difficulty: 'Medium', xpReward: 60, topic: 'SQL & Databases' },
      { id: 'sq4', text: 'What is a database index?', options: ['A list of all tables', 'A data structure that speeds up data retrieval at the cost of additional storage and write overhead', 'A backup of the database', 'A constraint on a column'], correctIndex: 1, explanation: 'Index: typically a B-tree structure. Dramatically speeds up SELECT WHERE/ORDER BY. Slows down INSERT/UPDATE/DELETE (index must be maintained).', difficulty: 'Easy', xpReward: 50, topic: 'SQL & Databases' },
      { id: 'sq5', text: 'What is the N+1 query problem?', options: ['Querying N tables', 'Executing 1 query to get N records then N additional queries to get related data for each', 'A deadlock involving N+1 transactions', 'Having N+1 indexes on a table'], correctIndex: 1, explanation: 'N+1: fetch 100 users (1 query) + 100 separate queries for each user\'s posts = 101 queries. Fix with JOIN, eager loading, or batched fetching. Major ORM performance pitfall.', difficulty: 'Medium', xpReward: 70, topic: 'SQL & Databases' },
      { id: 'sq6', text: 'What does ACID stand for?', options: ['Atomic, Consistent, Isolated, Durable', 'Async, Cached, Indexed, Distributed', 'All Constraints In Database', 'Automated Constraint Integration Design'], correctIndex: 0, explanation: 'ACID: Atomicity (all or nothing), Consistency (valid state to valid state), Isolation (concurrent txns don\'t interfere), Durability (committed data survives crashes).', difficulty: 'Easy', xpReward: 50, topic: 'SQL & Databases' },
      { id: 'sq7', text: 'What is a deadlock in database transactions?', options: ['A slow query', 'Two or more transactions each waiting for the other to release a lock, blocking indefinitely', 'A corrupted index', 'A full table scan'], correctIndex: 1, explanation: 'DB deadlock: Txn A holds lock on Row 1, wants Row 2. Txn B holds Row 2, wants Row 1. DB detects and kills one (the deadlock victim). Prevent with consistent lock ordering.', difficulty: 'Medium', xpReward: 80, topic: 'SQL & Databases' },
      { id: 'sq8', text: 'What is the difference between INNER JOIN and LEFT JOIN?', options: ['No difference', 'INNER JOIN: only rows with matches in both tables. LEFT JOIN: all rows from left table, NULLs for unmatched right rows', 'LEFT JOIN is faster', 'INNER JOIN returns more rows'], correctIndex: 1, explanation: 'INNER JOIN: intersection (both sides must have matching row). LEFT JOIN: all left rows kept, right side NULLs on no match.', difficulty: 'Easy', xpReward: 50, topic: 'SQL & Databases' },
      { id: 'sq9', text: 'What is a database transaction isolation level?', options: ['Connection security level', 'Controls how/when changes made by one transaction become visible to others — tradeoff between consistency and concurrency', 'The number of concurrent users', 'A backup strategy'], correctIndex: 1, explanation: 'Isolation levels (weakest to strongest): READ UNCOMMITTED, READ COMMITTED, REPEATABLE READ, SERIALIZABLE. Higher isolation = fewer anomalies but more contention.', difficulty: 'Hard', xpReward: 90, topic: 'SQL & Databases' },
      { id: 'sq10', text: 'When would you use a NoSQL database over a relational one?', options: ['Never', 'When you need flexible schema, horizontal scaling, or specific access patterns (documents, graphs, time-series)', 'When you need transactions', 'NoSQL is always faster'], correctIndex: 1, explanation: 'NoSQL trade-offs: give up ACID guarantees (usually), gain: flexible schema, horizontal scaling, specific data models. Choose NoSQL for variable structure, massive scale, or key-value/document/graph access patterns.', difficulty: 'Medium', xpReward: 70, topic: 'SQL & Databases' },
      { id: 'sq11', text: 'What is database normalization?', options: ['Speeding up queries', 'Organizing data to reduce redundancy and improve integrity by splitting into related tables', 'Encrypting the database', 'Backing up tables'], correctIndex: 1, explanation: 'Normalization: 1NF (atomic values), 2NF (no partial dependency), 3NF (no transitive dependency). Reduces update anomalies. Denormalization trades redundancy for read performance.', difficulty: 'Medium', xpReward: 70, topic: 'SQL & Databases' },
    ]
  },
  {
    id: 'book_cloud',
    title: 'Nimbus Architect',
    author: 'Bezos the Sky-Lord',
    description: 'Build castles in the sky. Scaling, S3, and Serverless.',
    content: ["Cloud computing is the on-demand availability of computer system resources.", "IaaS, PaaS, and SaaS are the three main models.", "Scalability is key."],
    rewardXp: 600,
    spellId: 'spell_cloud',
    questions: [
      { id: 'cl1', text: 'What is AWS S3 used for?', options: ['Computing', 'Storage', 'Networking', 'Database'], correctIndex: 1, explanation: 'S3 = Simple Storage Service for object storage.', difficulty: 'Easy', xpReward: 50, topic: 'Cloud & DevOps' },
      { id: 'cl2', text: 'What does "serverless" typically mean?', options: ['No servers', 'Managed runtime, pay per execution', 'Free hosting', 'Old mainframes'], correctIndex: 1, explanation: 'You don\'t manage servers; the provider runs your code on demand.', difficulty: 'Medium', xpReward: 60, topic: 'Cloud & DevOps' },
      { id: 'cl3', text: 'IaaS stands for?', options: ['Integration as a Service', 'Infrastructure as a Service', 'Internet as a Service', 'Identity as a Service'], correctIndex: 1, explanation: 'Infrastructure as a Service: VMs, networks, storage.', difficulty: 'Easy', xpReward: 50, topic: 'Cloud & DevOps' },
      { id: 'cl4', text: 'What is the difference between IaaS, PaaS, and SaaS?', options: ['They are the same', 'IaaS: raw infrastructure; PaaS: platform with runtime/OS managed; SaaS: fully managed application', 'SaaS is the cheapest always', 'PaaS requires no code'], correctIndex: 1, explanation: 'IaaS (EC2): you manage OS up. PaaS (Heroku/App Engine): you manage app+data. SaaS (Gmail): provider manages everything. More abstraction = less control but less operational burden.', difficulty: 'Easy', xpReward: 55, topic: 'Cloud & DevOps' },
      { id: 'cl5', text: 'What is auto-scaling in cloud computing?', options: ['Upgrading server hardware', 'Automatically adding or removing compute resources based on demand', 'Backing up data automatically', 'Compressing data to save space'], correctIndex: 1, explanation: 'Auto-scaling: policies (CPU%, request count) trigger spinning up new instances under load and terminating them when load drops. Key to cost efficiency and reliability.', difficulty: 'Medium', xpReward: 65, topic: 'Cloud & DevOps' },
      { id: 'cl6', text: 'What is a CDN (Content Delivery Network)?', options: ['A type of database', 'Geographically distributed servers that cache static assets closer to users to reduce latency', 'A cloud firewall', 'A container registry'], correctIndex: 1, explanation: 'CDN: edge servers cache content (JS, images, CSS) globally. User requests route to nearest PoP (Point of Presence). Reduces latency, offloads origin server. Examples: Cloudflare, AWS CloudFront.', difficulty: 'Easy', xpReward: 55, topic: 'Cloud & DevOps' },
      { id: 'cl7', text: 'What is blue-green deployment?', options: ['A color-coded alert system', 'Running two identical production environments, switching traffic from old (blue) to new (green) instantly', 'A Kubernetes pod strategy', 'A database backup approach'], correctIndex: 1, explanation: 'Blue-green: both versions live simultaneously. Flip load balancer from blue to green. Zero downtime. Rollback = flip back. Requires double the infrastructure cost temporarily.', difficulty: 'Medium', xpReward: 75, topic: 'Cloud & DevOps' },
      { id: 'cl8', text: 'What is container orchestration?', options: ['Packaging code into containers', 'Automated management of container lifecycle: scheduling, scaling, health checks, networking', 'A CI/CD pipeline', 'A cloud storage format'], correctIndex: 1, explanation: 'Container orchestration (Kubernetes, ECS): decides where containers run, restarts failed ones, scales them, manages networking. Essential for running containers at scale in production.', difficulty: 'Hard', xpReward: 80, topic: 'Cloud & DevOps' },
      { id: 'cl9', text: 'What are the main trade-offs of serverless functions?', options: ['Always cheaper, no downsides', 'Cold starts, execution time limits, vendor lock-in; gains: no server management, automatic scaling, pay-per-use', 'Requires dedicated hardware', 'Only works for batch jobs'], correctIndex: 1, explanation: 'Serverless trade-offs: cold start latency (first invocation), max execution duration, stateless (no in-memory state between calls). Great for event-driven, spiky workloads.', difficulty: 'Medium', xpReward: 75, topic: 'Cloud & DevOps' },
      { id: 'cl10', text: 'What is the shared responsibility model in cloud security?', options: ['Provider is responsible for everything', 'Cloud provider secures the infrastructure; customer secures data, IAM, application configuration', 'Customer is responsible for hardware', 'Security is optional in the cloud'], correctIndex: 1, explanation: 'AWS/GCP/Azure: provider secures physical facilities, hypervisor, network. You secure: OS patches, firewall rules, IAM permissions, data encryption, application code.', difficulty: 'Medium', xpReward: 70, topic: 'Cloud & DevOps' },
      { id: 'cl11', text: 'What is infrastructure as code (IaC)?', options: ['Writing code that runs on servers', 'Defining and provisioning infrastructure through machine-readable config files (Terraform, CloudFormation)', 'A monitoring tool', 'An API design pattern'], correctIndex: 1, explanation: 'IaC: declare desired infrastructure in code. Version-controlled, reproducible, diff-able. Terraform (multi-cloud), CloudFormation (AWS-native). Enables DevOps automation and drift detection.', difficulty: 'Medium', xpReward: 70, topic: 'Cloud & DevOps' },
    ]
  },
  {
    id: 'book_kotlin',
    title: 'Kotlin Kinetics',
    author: 'JetBrains Guild',
    description: 'A modern, concise dialect of the Java lands.',
    content: ["Kotlin is a cross-platform, statically typed, general-purpose programming language with type inference.", "It is fully interoperable with Java."],
    rewardXp: 550,
    spellId: 'spell_kotlin',
    questions: [
      { id: 'ko1', text: 'Is Kotlin interoperable with Java?', options: ['Yes', 'No', 'Only on Tuesdays', 'With a paid plugin'], correctIndex: 0, explanation: 'Yes, 100%. You can call Java from Kotlin and vice versa.', difficulty: 'Easy', xpReward: 50, topic: 'Backend & Servers' },
      { id: 'ko2', text: 'What does ?. do in Kotlin?', options: ['Optional chaining', 'Safe call (null-safe)', 'Ternary operator', 'Async await'], correctIndex: 1, explanation: 'Safe call: returns null if the receiver is null.', difficulty: 'Medium', xpReward: 60, topic: 'Backend & Servers' },
      { id: 'ko3', text: 'What is a data class in Kotlin?', options: ['A class that holds only integers', 'A class that auto-generates equals, hashCode, toString, copy, and component functions based on constructor properties', 'An abstract base class', 'A sealed class subtype'], correctIndex: 1, explanation: 'data class: compiler generates boilerplate. copy() creates modified copies. Ideal for immutable value objects. Destructuring via componentN functions.', difficulty: 'Easy', xpReward: 55, topic: 'Backend & Servers' },
      { id: 'ko4', text: 'What is the Elvis operator ?: in Kotlin?', options: ['A comparison operator', 'Returns the left value if non-null, otherwise returns the right value', 'A string concatenation operator', 'Marks a function as nullable'], correctIndex: 1, explanation: 'Elvis: val x = nullableVal ?: default. Equivalent to: if (nullableVal != null) nullableVal else default. Concisely handles null fallbacks.', difficulty: 'Easy', xpReward: 55, topic: 'Backend & Servers' },
      { id: 'ko5', text: 'What are Kotlin coroutines?', options: ['A thread pool manager', 'Lightweight concurrency primitives that allow writing async code in a sequential style using suspend functions', 'A UI rendering engine', 'A type of loop'], correctIndex: 1, explanation: 'Coroutines: suspend functions can pause without blocking a thread. Structured concurrency via CoroutineScope. Much cheaper than threads. Backed by coroutine dispatchers (Main, IO, Default).', difficulty: 'Hard', xpReward: 90, topic: 'Concurrency' },
      { id: 'ko6', text: 'What is the difference between val and var in Kotlin?', options: ['No difference', 'val is read-only (assigned once); var is mutable (can be reassigned)', 'val is for primitives only', 'var is only for global variables'], correctIndex: 1, explanation: 'val: like final in Java, reference cannot be reassigned. var: mutable reference. Prefer val by default; use var only when mutation is required.', difficulty: 'Easy', xpReward: 50, topic: 'Backend & Servers' },
      { id: 'ko7', text: 'What is a sealed class in Kotlin?', options: ['An encrypted class', 'A class hierarchy where all subclasses are known at compile time — enables exhaustive when expressions', 'A class that cannot be instantiated', 'An inline class'], correctIndex: 1, explanation: 'sealed class: all subtypes must be in the same module. The compiler knows every case, so when expressions can be exhaustive without an else branch. Perfect for modeling states and results.', difficulty: 'Medium', xpReward: 70, topic: 'OOP & Design Patterns' },
      { id: 'ko8', text: 'What is an extension function in Kotlin?', options: ['A function in a subclass', 'A function added to an existing class without modifying its source code or subclassing', 'An inline function', 'A lambda function'], correctIndex: 1, explanation: 'Extension functions: fun String.reverse() = this.reversed(). Called as if a method on the class. Does not modify the class; resolved statically at compile time.', difficulty: 'Medium', xpReward: 65, topic: 'Backend & Servers' },
      { id: 'ko9', text: 'What does the inline keyword do to a Kotlin function?', options: ['Makes it run faster always', 'Copies the function body at the call site, eliminating lambda object allocation overhead', 'Makes it thread-safe', 'Prevents overriding'], correctIndex: 1, explanation: 'inline: compiler substitutes the function body instead of a call. Eliminates the lambda object and call overhead. Use for higher-order functions that take lambdas. Cannot use non-local returns without it.', difficulty: 'Hard', xpReward: 85, topic: 'Backend & Servers' },
      { id: 'ko10', text: 'What is companion object in Kotlin?', options: ['A separate class linked by name', 'A singleton object scoped to a class — provides static-like members in Kotlin', 'An anonymous object', 'A coroutine scope'], correctIndex: 1, explanation: 'companion object: one per class, accessed via ClassName.member. Replaces Java static methods/fields. Can implement interfaces. Members are not truly static but behave like them.', difficulty: 'Medium', xpReward: 65, topic: 'Backend & Servers' },
    ]
  },
  {
    id: 'book_cicd',
    title: 'The Pipeline of Prometheus',
    author: 'Jenkins the Construct',
    description: 'Automate the forge. Build, Test, and Deploy.',
    content: ["Continuous Integration and Continuous Delivery.", "Automate the testing and deployment of code.", "Fail fast, fix fast."],
    rewardXp: 700,
    spellId: 'spell_cicd',
    questions: [
      { id: 'ci1', text: 'What is CI?', options: ['Continuous Integration', 'Code Injection', 'Cloud Interface', 'Common Interface'], correctIndex: 0, explanation: 'CI = frequently merging and building to catch issues early.', difficulty: 'Easy', xpReward: 50, topic: 'Testing & CI/CD' },
      { id: 'ci2', text: 'What is a unit test?', options: ['Tests one module in isolation', 'Tests the whole app', 'Tests network only', 'Manual QA'], correctIndex: 0, explanation: 'Unit tests verify a single function or class in isolation.', difficulty: 'Easy', xpReward: 50, topic: 'Testing & CI/CD' },
      { id: 'ci3', text: 'CD can mean?', options: ['Compact Disc', 'Continuous Delivery or Deployment', 'Code Delete', 'Cache Disable'], correctIndex: 1, explanation: 'Continuous Delivery (manual release) or Deployment (auto release).', difficulty: 'Easy', xpReward: 50, topic: 'Testing & CI/CD' },
      { id: 'ci4', text: 'What is the difference between unit, integration, and end-to-end tests?', options: ['They are the same', 'Unit: isolated function; Integration: multiple components together; E2E: full user journey through the real system', 'Unit tests are slowest', 'E2E tests use mocks exclusively'], correctIndex: 1, explanation: 'Test pyramid: unit (fast, cheap, many), integration (slower, real dependencies), E2E (slowest, most confidence, fewest). Balance is key.', difficulty: 'Medium', xpReward: 65, topic: 'Testing & CI/CD' },
      { id: 'ci5', text: 'What is the difference between mocking and stubbing?', options: ['No difference', 'Stub: returns canned responses; Mock: verifies interactions (calls, arguments) were made correctly', 'Mocking is only for databases', 'Stubbing is used in E2E tests'], correctIndex: 1, explanation: 'Stub: fake that returns data. Mock: fake that also asserts how it was called. Spy: wraps real object and records calls. Terminology varies by framework.', difficulty: 'Medium', xpReward: 70, topic: 'Testing & CI/CD' },
      { id: 'ci6', text: 'What is TDD (Test-Driven Development)?', options: ['Writing tests after the code', 'Red-Green-Refactor: write failing test, write minimal code to pass, then refactor', 'Testing in production', 'Using automated test generators'], correctIndex: 1, explanation: 'TDD cycle: Red (failing test), Green (minimal code to pass), Refactor (clean up). Forces testable design, documents intent, prevents over-engineering.', difficulty: 'Medium', xpReward: 70, topic: 'Testing & CI/CD' },
      { id: 'ci7', text: 'What does code coverage measure?', options: ['Code quality score', 'Percentage of code lines/branches executed during tests — indicates untested paths', 'Number of passing tests', 'Runtime performance'], correctIndex: 1, explanation: 'Coverage metrics: line, branch, statement, function. 80% is common target. High coverage != correct tests (you can have 100% coverage with bad assertions). Branch coverage is more meaningful than line.', difficulty: 'Medium', xpReward: 65, topic: 'Testing & CI/CD' },
      { id: 'ci8', text: 'What is a Docker container?', options: ['A virtual machine', 'A lightweight isolated environment that packages code and dependencies, sharing the host OS kernel', 'A cloud service', 'A test runner'], correctIndex: 1, explanation: 'Container: OS-level isolation using namespaces and cgroups. Faster and lighter than VMs. Consistent across dev/CI/prod. Docker image = blueprint; container = running instance.', difficulty: 'Medium', xpReward: 65, topic: 'Cloud & DevOps' },
      { id: 'ci9', text: 'What is a CI pipeline artifact?', options: ['A test failure', 'A file produced by the build step (compiled binary, Docker image, test report) stored for later stages', 'A configuration file', 'A deployed application'], correctIndex: 1, explanation: 'Artifact: output of a build stage passed to subsequent stages or stored for deployment. Examples: JAR/WAR files, Docker images, npm bundles. Enables reproducible deployments.', difficulty: 'Medium', xpReward: 65, topic: 'Testing & CI/CD' },
      { id: 'ci10', text: 'What is mutation testing?', options: ['Testing with random data', 'Introducing deliberate code mutations to verify tests actually catch bugs — measures test suite quality', 'A security testing technique', 'Testing on multiple platforms'], correctIndex: 1, explanation: 'Mutation testing: automatically mutates code (change + to -, flip conditions). A surviving mutant (tests still pass) reveals a gap in test assertions. Tools: PIT (Java), Stryker (JS/TS).', difficulty: 'Hard', xpReward: 90, topic: 'Testing & CI/CD' },
      { id: 'ci11', text: 'What is a feature flag (feature toggle)?', options: ['A bug tracker label', 'A mechanism to enable/disable features at runtime without deploying new code', 'A git branch strategy', 'A code review tag'], correctIndex: 1, explanation: 'Feature flags: decouple deployment from release. Deploy dark (flag off), enable for % of users, roll back instantly without redeploying. Enables trunk-based development and canary releases.', difficulty: 'Medium', xpReward: 70, topic: 'Testing & CI/CD' },
    ]
  },
  {
    id: 'book_react',
    title: 'The Reactive Arcana',
    author: 'Facebook Guild',
    description: 'Master the Component lifecycle.',
    content: ["React is a library for building user interfaces.", "Components are the building blocks."],
    rewardXp: 600,
    spellId: 'spell_react',
    questions: [
      { id: 'rq1', text: 'What is JSX?', options: ['JavaScript XML', 'Java Syntax', 'JSON X', 'Just Screen'], correctIndex: 0, explanation: 'JSX is a syntax extension that looks like HTML in JavaScript.', difficulty: 'Easy', xpReward: 50, topic: 'React & Frontend' },
      { id: 'rq2', text: 'When does useEffect run?', options: ['On every keystroke', 'After render (by default)', 'Only once at mount', 'Never'], correctIndex: 1, explanation: 'useEffect runs after render. Dependencies control when it re-runs.', difficulty: 'Medium', xpReward: 60, topic: 'React & Frontend' },
      { id: 'rq3', text: 'What is the Virtual DOM?', options: ['A 3D game engine', 'In-memory representation of the DOM for diffing', 'Shadow DOM', 'A browser plugin'], correctIndex: 1, explanation: 'React keeps a lightweight copy of the DOM to compute minimal updates.', difficulty: 'Medium', xpReward: 60, topic: 'React & Frontend' },
      { id: 'rq4', text: 'What is React reconciliation?', options: ['Merging two components', 'The process of diffing the new virtual DOM tree against the previous one to compute minimal real DOM updates', 'Syncing state with a server', 'Error handling in React'], correctIndex: 1, explanation: 'Reconciliation: React diffs old vs new virtual DOM trees. Uses heuristics (same-level comparison, key prop for lists) to determine what changed. Keys help React match list items across renders.', difficulty: 'Hard', xpReward: 85, topic: 'React & Frontend' },
      { id: 'rq5', text: 'What is the difference between useMemo and useCallback?', options: ['No difference', 'useMemo memoizes a computed value; useCallback memoizes a function reference', 'useCallback is faster', 'useMemo is only for arrays'], correctIndex: 1, explanation: 'useMemo: returns a memoized value (recomputed only when deps change). useCallback: returns a memoized function (new reference only when deps change). Both optimize re-renders.', difficulty: 'Hard', xpReward: 85, topic: 'React & Frontend' },
      { id: 'rq6', text: 'What does React.memo do?', options: ['Caches API responses', 'Wraps a component to skip re-rendering if props have not changed (shallow comparison)', 'Creates a memoized state value', 'Prevents useEffect from running'], correctIndex: 1, explanation: 'React.memo: HOC that shallowly compares props. If unchanged, skips re-render. Does not help if props are new objects each render (use useMemo/useCallback for that).', difficulty: 'Medium', xpReward: 70, topic: 'React & Frontend' },
      { id: 'rq7', text: 'What is the difference between useEffect and useLayoutEffect?', options: ['No difference', 'useLayoutEffect fires synchronously after DOM mutations, before browser paint; useEffect fires asynchronously after paint', 'useLayoutEffect is for animations only', 'useEffect is deprecated'], correctIndex: 1, explanation: 'useLayoutEffect: runs before the browser paints — use for DOM measurements or preventing layout flicker. useEffect: runs after paint — preferred for data fetching, subscriptions.', difficulty: 'Hard', xpReward: 90, topic: 'React & Frontend' },
      { id: 'rq8', text: 'What is React Suspense used for?', options: ['Catching errors', 'Declaratively showing fallback UI while components or data are loading (lazy imports, async data)', 'Memoizing expensive calculations', 'Managing global state'], correctIndex: 1, explanation: 'Suspense: wraps components that may "suspend" (throw a Promise). Shows fallback while waiting. Used with React.lazy() for code splitting and with data fetching frameworks.', difficulty: 'Hard', xpReward: 85, topic: 'React & Frontend' },
      { id: 'rq9', text: 'What is prop drilling and how do you avoid it?', options: ['A performance technique', 'Passing props through many intermediate components; avoided via Context API, state management libraries, or component composition', 'A React bug', 'Using too many props'], correctIndex: 1, explanation: 'Prop drilling: passing data many levels deep. Solutions: React Context (for infrequent updates), Zustand/Redux (for complex state), component composition (pass children directly).', difficulty: 'Medium', xpReward: 70, topic: 'React & Frontend' },
      { id: 'rq10', text: 'What is the purpose of the key prop in React lists?', options: ['Styling list items', 'Helps React identify which items changed, were added, or removed — enables efficient list reconciliation', 'Required for onClick handlers', 'Sorts list items'], correctIndex: 1, explanation: 'key: unique identifier per list item. React uses it to match elements across renders. Without stable keys, React may recreate DOM nodes unnecessarily or mix up component state.', difficulty: 'Medium', xpReward: 65, topic: 'React & Frontend' },
      { id: 'rq11', text: 'What is the Context API in React?', options: ['A REST API client', 'A way to pass data through the component tree without prop drilling, via a Provider/Consumer pattern', 'A state management library', 'A routing solution'], correctIndex: 1, explanation: 'Context: createContext, Provider wraps tree, useContext consumes value. Good for themes, auth state, locale. Avoid for frequently-changing values (causes broad re-renders).', difficulty: 'Medium', xpReward: 65, topic: 'React & Frontend' },
    ]
  },
  {
    id: 'book_git',
    title: 'The Grimoire of Git',
    author: 'Torvalds',
    description: 'Version control mastery.',
    content: ["Git is a distributed version control system.", "Track changes in source code."],
    rewardXp: 500,
    spellId: 'spell_git',
    questions: [
      { id: 'g1', text: 'What creates a save point?', options: ['Save', 'Commit', 'Push', 'Add'], correctIndex: 1, explanation: 'Commit records a snapshot of the staging area.', difficulty: 'Easy', xpReward: 50, topic: 'Git & Version Control' },
      { id: 'g2', text: 'What does git merge do?', options: ['Deletes history', 'Combines branches', 'Uploads to GitHub', 'Reverts changes'], correctIndex: 1, explanation: 'Merge integrates changes from another branch into the current one.', difficulty: 'Easy', xpReward: 50, topic: 'Git & Version Control' },
      { id: 'g3', text: 'Rebase vs merge?', options: ['Rebase rewrites history; merge adds a merge commit', 'They are the same', 'Rebase is only for remote', 'Merge deletes branches'], correctIndex: 0, explanation: 'Rebase replays commits on top of another branch; merge creates a merge commit.', difficulty: 'Medium', xpReward: 60, topic: 'Git & Version Control' },
      { id: 'g4', text: 'What do the three modes of git reset do (soft, mixed, hard)?', options: ['All three delete commits permanently', 'Soft: move HEAD only; Mixed: unstage changes; Hard: discard all changes to working directory', 'Hard is the safest option', 'Soft deletes commit history'], correctIndex: 1, explanation: 'git reset --soft: HEAD moves, staging/working tree unchanged. --mixed (default): HEAD moves, staging cleared. --hard: HEAD moves, staging + working directory wiped. Hard is destructive.', difficulty: 'Hard', xpReward: 90, topic: 'Git & Version Control' },
      { id: 'g5', text: 'What does git cherry-pick do?', options: ['Selects the best branch', 'Applies the changes from a specific commit onto the current branch', 'Deletes unwanted commits', 'Merges only selected files'], correctIndex: 1, explanation: 'cherry-pick: takes one commit\'s diff and applies it as a new commit. Useful for backporting bug fixes to release branches without merging the full feature branch.', difficulty: 'Medium', xpReward: 70, topic: 'Git & Version Control' },
      { id: 'g6', text: 'What is git bisect used for?', options: ['Splitting a repository', 'Binary search through commit history to find which commit introduced a bug', 'Merging two branches', 'Comparing two files'], correctIndex: 1, explanation: 'git bisect: mark a good commit and a bad commit, then Git binary-searches. You test each midpoint and mark good/bad until the culprit commit is found. Dramatically speeds up root cause analysis.', difficulty: 'Hard', xpReward: 85, topic: 'Git & Version Control' },
      { id: 'g7', text: 'What is the difference between git fetch and git pull?', options: ['No difference', 'git fetch downloads remote changes without merging; git pull fetches and immediately merges into current branch', 'git fetch is destructive', 'git pull only downloads new branches'], correctIndex: 1, explanation: 'fetch: safe, just updates remote-tracking refs. pull = fetch + merge (or rebase). Prefer fetch + review + merge for control, especially on shared branches.', difficulty: 'Medium', xpReward: 65, topic: 'Git & Version Control' },
      { id: 'g8', text: 'What is a git stash?', options: ['A remote backup', 'Temporarily shelves uncommitted changes so you can switch context, then restore them later', 'A type of branch', 'A commit message template'], correctIndex: 1, explanation: 'git stash: saves working directory + index changes onto a stack. git stash pop restores. Useful for switching branches mid-work without committing. Named stashes: git stash push -m "name".', difficulty: 'Easy', xpReward: 55, topic: 'Git & Version Control' },
      { id: 'g9', text: 'What is a monorepo git strategy?', options: ['One repo per service', 'A single repository containing multiple projects or packages, enabling atomic cross-project commits', 'A rebasing strategy', 'A branch naming convention'], correctIndex: 1, explanation: 'Monorepo: all code in one repo. Benefits: atomic cross-package changes, unified CI, consistent tooling. Challenges: repo size, selective builds. Tools: Nx, Turborepo, Bazel.', difficulty: 'Hard', xpReward: 80, topic: 'Git & Version Control' },
      { id: 'g10', text: 'What does git reflog track?', options: ['Remote commits only', 'A log of all HEAD movements (commits, resets, checkouts) — allows recovery from accidental resets', 'Deleted branches', 'Merge conflicts'], correctIndex: 1, explanation: 'reflog: local safety net. Even after git reset --hard or accidental branch deletion, reflog shows previous HEAD positions. Find lost commit SHA and git checkout/cherry-pick it.', difficulty: 'Hard', xpReward: 85, topic: 'Git & Version Control' },
      { id: 'g11', text: 'What is trunk-based development?', options: ['Committing directly to a single long-lived branch (trunk/main) with short-lived feature branches or direct commits', 'A git branching model with many long-lived branches', 'A strategy for managing large git repos', 'A code review process'], correctIndex: 0, explanation: 'Trunk-based dev: integrates frequently to main (daily or multiple times per day). Reduces merge conflicts and integration hell. Requires feature flags and strong CI. Opposite of Gitflow.', difficulty: 'Medium', xpReward: 70, topic: 'Git & Version Control' },
    ]
  },
  {
    id: 'book_datastruct',
    title: 'Codex of Structures',
    author: 'Ada',
    description: 'Arrays, Linked Lists, Trees.',
    content: ["Data structures organize data efficiently."],
    rewardXp: 750,
    questions: [
      { id: 'ds1', text: 'LIFO?', options: ['Queue', 'Stack', 'Array', 'Tree'], correctIndex: 1, explanation: 'Last In, First Out — stack.', difficulty: 'Easy', xpReward: 50, topic: 'Data Structures' },
      { id: 'ds2', text: 'Hash table average lookup time?', options: ['O(n)', 'O(log n)', 'O(1)', 'O(n^2)'], correctIndex: 2, explanation: 'With a good hash function, average case is constant time.', difficulty: 'Medium', xpReward: 60, topic: 'Data Structures' },
      { id: 'ds3', text: 'Binary search tree: left child is ___ than parent?', options: ['Greater', 'Less', 'Equal', 'Unrelated'], correctIndex: 1, explanation: 'In a BST, left subtree contains smaller keys.', difficulty: 'Easy', xpReward: 50, topic: 'Data Structures' },
      { id: 'ds4', text: 'What property does a min-heap guarantee?', options: ['Sorted order', 'The minimum element is always at the root', 'All nodes are equal', 'Left subtree is a BST'], correctIndex: 1, explanation: 'Min-heap: every node is smaller than or equal to its children. Root is always the minimum. Heap insert/extract: O(log n). Used in priority queues and Dijkstra\'s algorithm.', difficulty: 'Easy', xpReward: 55, topic: 'Data Structures' },
      { id: 'ds5', text: 'What is the difference between adjacency list and adjacency matrix for graphs?', options: ['No difference', 'Adjacency list: O(V+E) space, efficient for sparse graphs; Adjacency matrix: O(V^2) space, O(1) edge lookup, better for dense graphs', 'Matrix is always faster', 'List uses more memory always'], correctIndex: 1, explanation: 'Adjacency list: each node stores its neighbors — memory efficient for sparse graphs. Matrix: V×V boolean/weight grid — O(1) "does edge exist?" check. Most real-world graphs are sparse.', difficulty: 'Medium', xpReward: 70, topic: 'Data Structures' },
      { id: 'ds6', text: 'What problem does a union-find (disjoint set union) data structure solve?', options: ['Sorting elements', 'Efficiently tracking which elements belong to the same connected component, with near-O(1) union and find operations', 'Shortest path', 'Hash collision resolution'], correctIndex: 1, explanation: 'Union-Find: supports union(a,b) and find(a). With path compression + union by rank, operations are nearly O(1) amortized. Used in Kruskal\'s MST, network connectivity, Percolation.', difficulty: 'Hard', xpReward: 90, topic: 'Data Structures' },
      { id: 'ds7', text: 'What is a skip list?', options: ['A type of sorted linked list', 'A probabilistic layered linked list enabling O(log n) search/insert/delete — an alternative to balanced BSTs', 'A cache data structure', 'A sorted array variant'], correctIndex: 1, explanation: 'Skip list: multiple linked list layers with increasing stride. Top layer skips far, bottom has every element. Probabilistically balanced. Used in Redis sorted sets, LevelDB.', difficulty: 'Hard', xpReward: 90, topic: 'Data Structures' },
      { id: 'ds8', text: 'What is a Bloom filter?', options: ['A sorting algorithm', 'A space-efficient probabilistic structure that tests set membership — can have false positives but never false negatives', 'A hash table variant', 'A type of binary tree'], correctIndex: 1, explanation: 'Bloom filter: bit array + multiple hash functions. Adding: set bits. Querying: if all bits set, "probably yes"; if any bit unset, "definitely no". Used in databases, caches to avoid expensive lookups.', difficulty: 'Hard', xpReward: 95, topic: 'Data Structures' },
      { id: 'ds9', text: 'What is the time complexity of inserting into a balanced BST (e.g., AVL or Red-Black tree)?', options: ['O(1)', 'O(log n)', 'O(n)', 'O(n log n)'], correctIndex: 1, explanation: 'Balanced BST insert: O(log n) — tree height is bounded by log n due to balancing. AVL: strict balance, faster lookups. Red-Black: relaxed balance, faster inserts. Both O(log n).', difficulty: 'Medium', xpReward: 70, topic: 'Data Structures' },
      { id: 'ds10', text: 'What is a trie (prefix tree)?', options: ['A type of hash table', 'A tree where each node represents a character, enabling O(L) insert/search for strings of length L', 'A balanced binary tree', 'A graph traversal structure'], correctIndex: 1, explanation: 'Trie: stores strings by shared prefixes. Root to leaf = one word. O(L) operations (L = string length), independent of number of strings. Used in autocomplete, spell checking, IP routing.', difficulty: 'Medium', xpReward: 75, topic: 'Data Structures' },
      { id: 'ds11', text: 'What is the difference between a stack and a queue?', options: ['No difference', 'Stack: LIFO (last in, first out); Queue: FIFO (first in, first out)', 'Queue is always faster', 'Stack allows random access'], correctIndex: 1, explanation: 'Stack: push/pop from same end (like a stack of plates). Queue: enqueue at back, dequeue from front (like a line). Both O(1) operations. Stack used for DFS/undo; Queue for BFS/scheduling.', difficulty: 'Easy', xpReward: 50, topic: 'Data Structures' },
    ]
  },
  {
    id: 'book_algo',
    title: 'Algorithms of Ancients',
    author: 'Al-Khwarizmi',
    description: 'Sorting and Searching.',
    content: ["Algorithms are steps to solve problems."],
    rewardXp: 800,
    questions: [
      { id: 'aq1', text: 'Binary Search O?', options: ['O(n)', 'O(log n)', 'O(1)', 'O(n^2)'], correctIndex: 1, explanation: 'Each step halves the search space: O(log n).', difficulty: 'Medium', xpReward: 50, topic: 'Algorithms' },
      { id: 'aq2', text: 'Quicksort average case?', options: ['O(n log n)', 'O(n)', 'O(n^2)', 'O(log n)'], correctIndex: 0, explanation: 'Average case O(n log n); worst O(n^2) if pivot is bad.', difficulty: 'Medium', xpReward: 60, topic: 'Algorithms' },
      { id: 'aq3', text: 'BFS uses which structure?', options: ['Stack', 'Queue', 'Heap', 'Array'], correctIndex: 1, explanation: 'Breadth-first search uses a queue to visit level by level.', difficulty: 'Medium', xpReward: 60, topic: 'Algorithms' },
      { id: 'aq4', text: 'What is dynamic programming?', options: ['Programming with dynamic types', 'Breaking a problem into overlapping subproblems and storing results to avoid recomputation', 'A runtime code generation technique', 'An OS memory allocation strategy'], correctIndex: 1, explanation: 'DP: memoization (top-down) or tabulation (bottom-up). Applies when: optimal substructure + overlapping subproblems. Classic: Fibonacci, knapsack, LCS, shortest paths.', difficulty: 'Medium', xpReward: 70, topic: 'Algorithms' },
      { id: 'aq5', text: 'What is the difference between BFS and DFS?', options: ['No difference', 'BFS explores level-by-level (queue); DFS explores depth-first (stack/recursion)', 'BFS is always faster', 'DFS uses more memory'], correctIndex: 1, explanation: 'BFS: queue, finds shortest path in unweighted graphs, good for level-order traversal. DFS: stack/recursion, good for cycle detection, topological sort, connected components.', difficulty: 'Easy', xpReward: 50, topic: 'Algorithms' },
      { id: 'aq6', text: 'What is a greedy algorithm?', options: ['An algorithm that uses excessive memory', 'Makes locally optimal choices at each step hoping to reach a global optimum', 'An algorithm that tries all possibilities', 'A randomised algorithm'], correctIndex: 1, explanation: 'Greedy: pick the best option at each step without backtracking. Works when greedy choice leads to global optimum (Dijkstra, Huffman, activity selection). Does not always work (0/1 knapsack).', difficulty: 'Medium', xpReward: 70, topic: 'Algorithms' },
      { id: 'aq7', text: 'What is amortized time complexity?', options: ['Average case complexity', 'Average cost per operation over a sequence of operations, smoothing out occasional expensive operations', 'Worst case divided by average', 'Memory complexity'], correctIndex: 1, explanation: 'Amortized: dynamic array push is O(n) when resizing but O(1) amortized over n pushes. Total cost of n operations divided by n. Useful for data structures with occasional expensive operations.', difficulty: 'Hard', xpReward: 90, topic: 'Algorithms' },
      { id: 'aq8', text: 'What is Dijkstra\'s algorithm used for?', options: ['Sorting arrays', 'Finding shortest paths from a source to all vertices in a weighted graph with non-negative edges', 'Minimum spanning tree', 'Cycle detection'], correctIndex: 1, explanation: 'Dijkstra: greedy shortest path. Uses a min-heap. O((V+E)logV) with binary heap. Does NOT work with negative edges (use Bellman-Ford). Basis of GPS, routing protocols.', difficulty: 'Medium', xpReward: 80, topic: 'Algorithms' },
      { id: 'aq9', text: 'What is the purpose of a hash function in a hash table?', options: ['Encrypting data', 'Mapping keys to array indices — enables O(1) average lookup, insert, delete', 'Sorting keys', 'Compressing values'], correctIndex: 1, explanation: 'Hash function maps key to index. Good hash: uniform distribution, fast, deterministic. Collisions handled by chaining (linked list at bucket) or open addressing (probing).', difficulty: 'Easy', xpReward: 50, topic: 'Algorithms' },
      { id: 'aq10', text: 'What is merge sort and why is it preferred over quicksort in some cases?', options: ['Merge sort is always faster', 'Merge sort is O(n log n) stable sort — preferred when stability matters or for linked lists; quicksort is in-place but unstable', 'Merge sort uses O(1) memory', 'They have the same worst case'], correctIndex: 1, explanation: 'Merge sort: O(n log n) always (no bad pivot). Stable (preserves order of equal elements). Uses O(n) extra space. Quicksort: average O(n log n), O(n^2) worst, in-place, unstable. Merge preferred for external sorting.', difficulty: 'Hard', xpReward: 85, topic: 'Algorithms' },
      { id: 'aq11', text: 'What is the P vs NP problem?', options: ['A programming language comparison', 'Whether every problem whose solution can be quickly verified (NP) can also be quickly solved (P)', 'A database complexity metric', 'A network protocol comparison'], correctIndex: 1, explanation: 'P: solvable in polynomial time. NP: solution verifiable in polynomial time. P vs NP: is P = NP? Major unsolved problem. If P=NP, most cryptography would break. Most believe P != NP.', difficulty: 'Hard', xpReward: 95, topic: 'Algorithms' },
    ]
  },
  {
    id: 'book_security',
    title: 'Shields of the Firewall',
    author: 'The Cryptographer',
    description: 'Defend against injection, XSS, and the dark arts.',
    content: ["Security is not optional.", "Never trust user input. Validate and sanitize.", "Use parameterized queries and HTTPS."],
    rewardXp: 700,
    questions: [
      { id: 'sec1', text: 'SQL Injection is best prevented by?', options: ['Using parameterized queries', 'Longer passwords', 'More servers', 'Faster CPU'], correctIndex: 0, explanation: 'Parameterized queries separate code from data.', difficulty: 'Easy', xpReward: 50, topic: 'Security' },
      { id: 'sec2', text: 'XSS stands for?', options: ['Cross-Site Scripting', 'Extra Secure Socket', 'XML Style Sheet', 'Extended Server Side'], correctIndex: 0, explanation: 'Attackers inject scripts into pages viewed by other users.', difficulty: 'Easy', xpReward: 50, topic: 'Security' },
      { id: 'sec3', text: 'What is CSRF (Cross-Site Request Forgery)?', options: ['A type of XSS attack', 'Tricking a logged-in user into unknowingly submitting a request to another site using their credentials', 'A brute force attack on passwords', 'A man-in-the-middle attack'], correctIndex: 1, explanation: 'CSRF: attacker\'s site sends a request to victim site; browser auto-attaches victim\'s cookies. Prevention: CSRF tokens, SameSite cookie attribute, checking Origin/Referer headers.', difficulty: 'Medium', xpReward: 70, topic: 'Security' },
      { id: 'sec4', text: 'What is the structure of a JWT (JSON Web Token)?', options: ['Username and password', 'Three Base64url-encoded parts: Header.Payload.Signature separated by dots', 'An encrypted database record', 'A session cookie'], correctIndex: 1, explanation: 'JWT: Header (alg+typ), Payload (claims: sub, exp, iat, custom), Signature (header+payload signed with secret or private key). Not encrypted by default — anyone can decode payload. Sign, don\'t just encode.', difficulty: 'Medium', xpReward: 75, topic: 'Security' },
      { id: 'sec5', text: 'Why is bcrypt preferred over SHA-256 for password hashing?', options: ['bcrypt is faster', 'bcrypt is intentionally slow and includes a salt, making brute-force and rainbow table attacks much harder', 'SHA-256 is deprecated', 'They are equivalent for passwords'], correctIndex: 1, explanation: 'bcrypt: work factor (cost) makes each hash slow (e.g., 100ms). SHA-256: microseconds per hash — GPUs can check billions/sec. bcrypt also embeds a random salt per hash, preventing rainbow tables.', difficulty: 'Medium', xpReward: 80, topic: 'Security' },
      { id: 'sec6', text: 'What is the OAuth 2.0 authorization code flow?', options: ['User sends password to third-party app', 'App redirects to auth server, user consents, auth server returns code, app exchanges code for access token', 'User logs in with a certificate', 'App uses a shared secret key'], correctIndex: 1, explanation: 'Auth code flow: redirect to IdP, user authenticates, IdP returns code to redirect URI, backend exchanges code + client_secret for access token (and refresh token). Code never exposed to browser JS.', difficulty: 'Hard', xpReward: 90, topic: 'Security' },
      { id: 'sec7', text: 'What does TLS/SSL protect against?', options: ['SQL injection', 'Eavesdropping and tampering of data in transit by encrypting the communication channel', 'DDoS attacks', 'Authentication bypass'], correctIndex: 1, explanation: 'TLS: encrypts data in transit (HTTPS). Provides: confidentiality (encryption), integrity (MAC), authentication (certificates). Does not protect against application-layer attacks (XSS, SQLi).', difficulty: 'Easy', xpReward: 55, topic: 'Security' },
      { id: 'sec8', text: 'What is the principle of least privilege?', options: ['Giving users maximum permissions for convenience', 'Granting only the minimum permissions necessary to perform a task — limits blast radius of compromised accounts', 'Making all data public', 'Using strong passwords'], correctIndex: 1, explanation: 'Least privilege: a user, process, or system component should have access only to what it needs. Limits damage from compromised credentials or vulnerabilities. Apply to IAM, DB users, service accounts.', difficulty: 'Easy', xpReward: 55, topic: 'Security' },
      { id: 'sec9', text: 'What is a rainbow table attack?', options: ['A colorful phishing attack', 'Using a precomputed lookup table of hash-to-plaintext mappings to reverse password hashes', 'A type of DDoS', 'An SSL vulnerability'], correctIndex: 1, explanation: 'Rainbow table: precomputed hash chains. If attacker gets your hash database, they look up hashes to find passwords. Defense: add a random salt per password before hashing (renders precomputed tables useless).', difficulty: 'Medium', xpReward: 75, topic: 'Security' },
      { id: 'sec10', text: 'What is rate limiting and why is it important for security?', options: ['Limiting server capacity', 'Restricting how many requests a client can make in a time window — prevents brute force, DoS, and credential stuffing', 'Slowing down a database', 'A network QoS mechanism only'], correctIndex: 1, explanation: 'Rate limiting: 100 requests/minute per IP/user. Prevents: password brute force, API abuse, scraping, DDoS amplification. Implement at API gateway or application layer. Return 429 Too Many Requests.', difficulty: 'Medium', xpReward: 70, topic: 'Security' },
      { id: 'sec11', text: 'What is Content Security Policy (CSP)?', options: ['A password policy', 'An HTTP response header that instructs browsers which sources are allowed to load scripts, styles, and other resources', 'A database access control', 'A firewall configuration'], correctIndex: 1, explanation: 'CSP: Content-Security-Policy header. Mitigates XSS by whitelisting allowed script/style sources. Example: "script-src \'self\' cdn.example.com". Violations reported to report-uri. Defence-in-depth for XSS.', difficulty: 'Hard', xpReward: 85, topic: 'Security' },
    ]
  },

  // SOFTWARE ARCHITECTURE
  {
    id: 'book_soft_arch',
    title: "The Architect's Grimoire",
    author: 'Martin of the Clean Code',
    description: 'Master patterns for structuring large systems.',
    content: [
      "Software architecture defines the high-level structure of a system.",
      "Key patterns: layered, microservices, event-driven, hexagonal.",
      "Good architecture delays decisions and keeps options open."
    ],
    rewardXp: 700,
    questions: [
      { id: 'sa1', text: 'What is the Hexagonal Architecture pattern?', options: ['A six-layer system', 'Ports and Adapters — domain logic isolated from infrastructure', 'A hexagon-shaped database schema', 'Six microservices communicating in a ring'], correctIndex: 1, explanation: 'Hexagonal (Ports & Adapters): domain logic at center, external systems connect via ports/adapters. Makes business logic testable without infrastructure.', difficulty: 'Hard', xpReward: 90, topic: 'Software Architecture' },
      { id: 'sa2', text: 'What does CQRS stand for?', options: ['Command Query Responsibility Segregation', 'Concurrent Query Runtime System', 'Command Queue Response Stack', 'Centralized Query Result Storage'], correctIndex: 0, explanation: 'CQRS separates read (query) and write (command) models. Commands mutate state; queries return data. Enables optimized read/write scaling.', difficulty: 'Medium', xpReward: 70, topic: 'Software Architecture' },
      { id: 'sa3', text: 'What is Domain-Driven Design (DDD)?', options: ['Designing databases first', 'Modeling software around business domains with a ubiquitous language', 'Using domain-specific languages only', 'A front-end design pattern'], correctIndex: 1, explanation: 'DDD: align software model with business domain. Key concepts: bounded contexts, aggregates, entities, value objects, domain events, ubiquitous language.', difficulty: 'Medium', xpReward: 70, topic: 'Software Architecture' },
      { id: 'sa4', text: 'What is an Aggregate in DDD?', options: ['A database join', 'A cluster of domain objects treated as a single unit for data changes', 'An average of values', 'A service that aggregates API responses'], correctIndex: 1, explanation: 'Aggregate: group of domain objects with a root entity. All changes go through the root. Enforces invariants and is the unit of consistency.', difficulty: 'Hard', xpReward: 90, topic: 'Software Architecture' },
      { id: 'sa5', text: 'What is the strangler fig pattern?', options: ['A code smell', 'Gradually replacing a legacy system by routing requests to new functionality', 'A security vulnerability', 'A database migration strategy'], correctIndex: 1, explanation: 'Strangler Fig: new system grows around the old one, gradually replacing it. Safe incremental migration — old and new coexist until legacy is fully replaced.', difficulty: 'Medium', xpReward: 80, topic: 'Software Architecture' },
      { id: 'sa6', text: 'What is a Bounded Context?', options: ['A limited scope API', 'An explicit boundary within which a domain model is consistent and applies', 'A container with resource limits', 'A context with a fixed number of threads'], correctIndex: 1, explanation: 'Bounded Context: explicit boundary where a particular domain model is defined and applicable. Terms have specific meanings inside but may mean different things outside.', difficulty: 'Hard', xpReward: 90, topic: 'Software Architecture' },
      { id: 'sa7', text: 'Event Sourcing means:', options: ['Logging events to a file', 'Storing all state changes as a sequence of events rather than current state', 'Using events for inter-service communication only', 'Sourcing events from a message broker'], correctIndex: 1, explanation: 'Event Sourcing: persist state as sequence of events. Replay events to reconstruct state. Provides audit log, enables temporal queries, supports event-driven architecture.', difficulty: 'Hard', xpReward: 100, topic: 'Software Architecture' },
      { id: 'sa8', text: 'What is the difference between a library and a framework?', options: ['No difference', 'A library you call; a framework calls you (Inversion of Control)', 'Frameworks are larger', 'Libraries are faster'], correctIndex: 1, explanation: "Library: your code calls it. Framework: it calls your code (Hollywood Principle / IoC). Framework controls the flow; you fill in the blanks.", difficulty: 'Easy', xpReward: 50, topic: 'Software Architecture' },
      { id: 'sa9', text: "What is Conway's Law?", options: ['Software complexity grows over time', 'Systems reflect the communication structure of the organisations that build them', 'Bugs are proportional to lines of code', 'Every system needs documentation'], correctIndex: 1, explanation: "Conway's Law: organisations design systems that mirror their communication structure. Inverse Conway Manoeuvre: design your org structure to get the architecture you want.", difficulty: 'Medium', xpReward: 70, topic: 'Software Architecture' },
      { id: 'sa10', text: 'What is the purpose of an anti-corruption layer?', options: ['Prevents SQL injection', 'Translates between models of two different systems/contexts', 'Encrypts inter-service traffic', 'Prevents circular dependencies'], correctIndex: 1, explanation: "Anti-Corruption Layer (ACL): translation layer between two bounded contexts with different models. Prevents the outer model's concepts from polluting your domain.", difficulty: 'Hard', xpReward: 90, topic: 'Software Architecture' },
      { id: 'sa11', text: 'What is a Saga in distributed systems?', options: ['A long function', 'A sequence of local transactions coordinated with compensating transactions', 'A database stored procedure', 'A multi-step API endpoint'], correctIndex: 1, explanation: 'Saga pattern: manage distributed transactions without 2PC. Each step has a compensating transaction. Choreography (events) or Orchestration (central coordinator).', difficulty: 'Hard', xpReward: 100, topic: 'Software Architecture' },
      { id: 'sa12', text: 'Microservices vs Monolith: when should you prefer a monolith?', options: ['Never', 'When starting out, team is small, or domain is not well understood', 'When performance matters', 'When using containers'], correctIndex: 1, explanation: 'Start with a monolith: simpler to develop, deploy, and debug. Move to microservices when you have clear domain boundaries, scaling needs, or multiple teams on separate services.', difficulty: 'Medium', xpReward: 70, topic: 'Software Architecture' },
    ]
  },

  // AI & MACHINE LEARNING
  {
    id: 'book_ai_ml',
    title: 'The Neural Codex',
    author: 'Turing the Arcane',
    description: 'Demystify machine learning — from gradient descent to transformers.',
    content: [
      "Machine learning: systems that learn from data without being explicitly programmed.",
      "Key paradigms: supervised, unsupervised, reinforcement learning.",
      "Neural networks: layers of weighted connections that approximate complex functions."
    ],
    rewardXp: 700,
    questions: [
      { id: 'ml1', text: 'What is gradient descent?', options: ['A mountain hiking algorithm', 'An optimisation algorithm that minimises loss by moving in the direction of steepest descent', 'A method for feature selection', 'A regularisation technique'], correctIndex: 1, explanation: 'Gradient descent updates model parameters iteratively: params -= learning_rate × gradient. The gradient points uphill; we move downhill to minimise loss.', difficulty: 'Medium', xpReward: 70, topic: 'AI & Machine Learning' },
      { id: 'ml2', text: 'What is overfitting?', options: ['Model is too simple', 'Model memorises training data, performs poorly on new data', 'Model trains too slowly', 'Model uses too little data'], correctIndex: 1, explanation: 'Overfitting: model learns noise in training data. High training accuracy, low validation accuracy. Fix with: more data, regularisation (L1/L2), dropout, early stopping.', difficulty: 'Easy', xpReward: 50, topic: 'AI & Machine Learning' },
      { id: 'ml3', text: "What does a transformer's attention mechanism do?", options: ['Filters noise from input', 'Weighs the importance of different input positions relative to each other', 'Transforms data to a different format', 'Compresses the input sequence'], correctIndex: 1, explanation: 'Self-attention: each token attends to all other tokens, computing weighted sum based on relevance. Enables capturing long-range dependencies — key to GPT, BERT, etc.', difficulty: 'Hard', xpReward: 100, topic: 'AI & Machine Learning' },
      { id: 'ml4', text: 'What is the bias-variance tradeoff?', options: ['Balancing dataset bias and variance', 'Underfitting (high bias) vs overfitting (high variance) — increasing model complexity trades bias for variance', 'Choosing between biased and unbiased estimators', 'A hardware tradeoff'], correctIndex: 1, explanation: 'High bias = model too simple, underfits. High variance = model too complex, overfits. Goal: sweet spot with low bias AND low variance through proper regularisation and model selection.', difficulty: 'Medium', xpReward: 80, topic: 'AI & Machine Learning' },
      { id: 'ml5', text: 'What is a confusion matrix?', options: ['A matrix of random values', 'A table showing TP, TN, FP, FN to evaluate classification performance', 'A matrix that confuses the model', 'A visualisation of neural network weights'], correctIndex: 1, explanation: 'Confusion matrix: rows = actual, columns = predicted. True Positive (TP), True Negative (TN), False Positive (FP), False Negative (FN). Basis for precision, recall, F1 score.', difficulty: 'Easy', xpReward: 50, topic: 'AI & Machine Learning' },
      { id: 'ml6', text: 'What is L2 regularisation (Ridge)?', options: ['Removing neurons randomly', 'Adding sum of squared weights to the loss function to penalise large weights', 'Setting weights to zero', 'Adding noise to training data'], correctIndex: 1, explanation: 'L2 (Ridge): loss += λ × Σw². Penalises large weights, shrinks them towards zero but rarely to zero. Reduces overfitting. L1 (Lasso) can zero out weights (feature selection).', difficulty: 'Medium', xpReward: 80, topic: 'AI & Machine Learning' },
      { id: 'ml7', text: 'What is backpropagation?', options: ['Running the model backwards', 'Propagating the gradient of the loss backwards through the network to compute weight updates', 'Reversing training data', 'A method of data augmentation'], correctIndex: 1, explanation: 'Backprop: chain rule applied layer by layer from output to input. Computes ∂Loss/∂w for each weight, enabling gradient descent to update the entire network.', difficulty: 'Hard', xpReward: 90, topic: 'AI & Machine Learning' },
      { id: 'ml8', text: 'What is transfer learning?', options: ['Moving a model between servers', 'Using a pre-trained model as a starting point for a new task', 'Transferring weights to a different architecture', 'Sharing model weights across users'], correctIndex: 1, explanation: 'Transfer learning: take a model trained on large dataset (e.g., ImageNet), fine-tune on your small dataset. Saves training time, works well when tasks share low-level features.', difficulty: 'Medium', xpReward: 70, topic: 'AI & Machine Learning' },
      { id: 'ml9', text: 'Precision vs Recall — when do you optimise for recall?', options: ['Always', 'When false negatives are more costly (e.g., cancer screening)', 'When false positives are more costly', 'When the dataset is balanced'], correctIndex: 1, explanation: 'High recall: minimize false negatives (missed positives). Critical when missing a positive is costly: cancer detection, fraud alerts, security threats. Trade-off: higher recall often means lower precision.', difficulty: 'Medium', xpReward: 80, topic: 'AI & Machine Learning' },
      { id: 'ml10', text: 'What is a vector embedding?', options: ['A compressed image format', 'A dense numerical representation of data (text, image, etc.) in a high-dimensional space', 'A type of neural network layer', 'An encryption of model weights'], correctIndex: 1, explanation: 'Embeddings map discrete objects (words, images) to continuous vectors. Similar objects cluster nearby. Foundation of word2vec, sentence transformers, and modern RAG systems.', difficulty: 'Medium', xpReward: 70, topic: 'AI & Machine Learning' },
      { id: 'ml11', text: 'What is the vanishing gradient problem?', options: ['Gradients explode to infinity', 'Gradients become very small in deep networks, making early layers learn slowly or not at all', 'Gradients become negative', 'The loss function disappears'], correctIndex: 1, explanation: 'In deep networks, gradients get multiplied through many layers during backprop. If activations (sigmoid, tanh) saturate, gradients shrink to near zero. Fix: ReLU, batch norm, residual connections.', difficulty: 'Hard', xpReward: 100, topic: 'AI & Machine Learning' },
      { id: 'ml12', text: 'What is RAG (Retrieval-Augmented Generation)?', options: ['A training technique', 'Augmenting LLM generation with retrieved context from an external knowledge base', 'Random Activation Gating', 'A regularisation method'], correctIndex: 1, explanation: 'RAG: retrieve relevant documents (via vector search), add to LLM prompt as context. Reduces hallucinations, keeps knowledge current without retraining. Used in production AI search systems.', difficulty: 'Hard', xpReward: 100, topic: 'AI & Machine Learning' },
    ]
  },

  // MOBILE DEVELOPMENT
  {
    id: 'book_mobile',
    title: "The Pocket Wizard's Guide",
    author: 'Expo the Elementalist',
    description: 'Build cross-platform mobile apps with React Native.',
    content: [
      "Mobile development targets iOS and Android from a single codebase.",
      "React Native: write JS/TS, render native components.",
      "Key considerations: performance, offline support, platform differences."
    ],
    rewardXp: 600,
    questions: [
      { id: 'mob1', text: 'What is the main thread in React Native?', options: ['JavaScript thread', 'The UI (main) thread — renders native views and handles user interactions', 'The network thread', 'The bridge thread'], correctIndex: 1, explanation: 'React Native has: JS thread (your code), UI/main thread (native rendering + user input), and native modules thread. Heavy JS work blocking the JS thread can stutter UI.', difficulty: 'Medium', xpReward: 70, topic: 'Mobile Development' },
      { id: 'mob2', text: 'What is the React Native Bridge (old architecture)?', options: ['A network bridge for APIs', 'An asynchronous message-passing layer between JS and native code via JSON serialisation', 'A layout bridge between components', 'A CI/CD tool'], correctIndex: 1, explanation: 'Old arch: JS and native communicate via a serialised JSON bridge (async, batched). New arch (JSI): synchronous direct calls via C++ layer — eliminates bridge overhead.', difficulty: 'Hard', xpReward: 90, topic: 'Mobile Development' },
      { id: 'mob3', text: 'What is Expo?', options: ['A testing framework', 'A platform + toolchain that simplifies React Native development with pre-built native modules', 'A state management library', 'An app store alternative'], correctIndex: 1, explanation: 'Expo wraps React Native with managed workflow, EAS build service, over-the-air updates, and a rich SDK. Trade-off: less control over native code.', difficulty: 'Easy', xpReward: 50, topic: 'Mobile Development' },
      { id: 'mob4', text: 'Difference between StyleSheet.create and inline styles in React Native?', options: ['No difference', 'StyleSheet.create validates styles at startup and enables optimisations; inline objects create new objects on every render', 'Inline styles support more properties', 'StyleSheet.create only works on iOS'], correctIndex: 1, explanation: 'StyleSheet.create: defined once, optimised, validated at startup. Inline styles: new object every render (minor perf cost). StyleSheet.create is preferred for perf + type safety.', difficulty: 'Medium', xpReward: 60, topic: 'Mobile Development' },
      { id: 'mob5', text: 'What is FlatList used for?', options: ['A flat navigation structure', 'Efficiently rendering large scrollable lists by only rendering visible items', 'A CSS layout helper', 'Displaying flat data without nesting'], correctIndex: 1, explanation: 'FlatList renders only visible items (virtual list). For large datasets, far more performant than mapping an array inside ScrollView. Use keyExtractor and getItemLayout for best performance.', difficulty: 'Easy', xpReward: 50, topic: 'Mobile Development' },
      { id: 'mob6', text: 'What is AsyncStorage?', options: ['Asynchronous state management', 'A simple, unencrypted key-value store for persisting data on device', 'A cloud storage API', "React's async storage hook"], correctIndex: 1, explanation: 'AsyncStorage: persistent, async key-value store on device. Good for user preferences, tokens, small data. Not encrypted (use SecureStore for sensitive data).', difficulty: 'Easy', xpReward: 50, topic: 'Mobile Development' },
      { id: 'mob7', text: 'What is the purpose of useWindowDimensions in React Native?', options: ['Measuring component size', 'Getting screen width/height that update on orientation change', 'Setting window title', 'Controlling app window position'], correctIndex: 1, explanation: 'useWindowDimensions: returns { width, height } and re-renders when dimensions change (e.g., rotation). Use instead of Dimensions.get() for responsive layouts.', difficulty: 'Medium', xpReward: 60, topic: 'Mobile Development' },
      { id: 'mob8', text: 'What is deep linking in mobile apps?', options: ['Accessing internal APIs', 'URLs that open specific screens/content directly inside an app', 'Low-level system access', 'Linking native libraries'], correctIndex: 1, explanation: 'Deep links: URLs like myapp://profile/123 open specific screens. Universal links (https://myapp.com/profile/123) work even if app not installed. Essential for notifications and marketing.', difficulty: 'Medium', xpReward: 70, topic: 'Mobile Development' },
      { id: 'mob9', text: 'What is an Over-The-Air (OTA) update in React Native?', options: ['Wireless charging', 'Updating JS bundle without going through the app store review process', 'Bluetooth app pairing', 'A streaming update protocol'], correctIndex: 1, explanation: 'OTA: push JS/asset updates directly to devices (e.g., via Expo Updates or CodePush). Bypasses store review for JS-only changes. Cannot update native code this way.', difficulty: 'Medium', xpReward: 70, topic: 'Mobile Development' },
      { id: 'mob10', text: 'What is the Hermes JavaScript engine?', options: ['A backend server', "Facebook's optimised JS engine for React Native — improves startup time and reduces memory", 'A JavaScript testing framework', 'A bundler for React Native'], correctIndex: 1, explanation: 'Hermes: bytecode-compiling JS engine for React Native. Pre-compiles JS to bytecode at build time → faster startup, lower memory. Enabled by default since RN 0.70.', difficulty: 'Hard', xpReward: 90, topic: 'Mobile Development' },
      { id: 'mob11', text: 'Controlled vs uncontrolled TextInput in React Native?', options: ['No difference', 'Controlled: value set via value prop + onChangeText; uncontrolled: manages own state internally', 'Controlled inputs are faster', 'Uncontrolled inputs only work on Android'], correctIndex: 1, explanation: 'Controlled TextInput: value comes from state, updated via onChangeText — single source of truth. React prefers controlled for predictability.', difficulty: 'Medium', xpReward: 60, topic: 'Mobile Development' },
      { id: 'mob12', text: 'What should you use instead of setInterval for animations in React Native?', options: ['requestAnimationFrame', 'The Animated API or Reanimated — runs on native thread, not JS thread', 'useEffect + setInterval', 'CSS transitions'], correctIndex: 1, explanation: 'Animated/Reanimated: run animations on the native thread. setInterval-based animations block the JS thread causing jank. Reanimated 2+ uses worklets — pure native execution.', difficulty: 'Hard', xpReward: 90, topic: 'Mobile Development' },
    ]
  },

  // OPERATING SYSTEMS
  {
    id: 'book_os',
    title: "The Kernel's Ancient Tome",
    author: 'Linus the Ascended',
    description: 'Understand processes, memory, and the OS beneath your code.',
    content: [
      "The OS manages hardware resources and provides abstractions for software.",
      "Key concepts: processes, threads, scheduling, virtual memory, file systems.",
      "Understanding the OS makes you a better programmer at every layer."
    ],
    rewardXp: 600,
    questions: [
      { id: 'os1', text: 'What is the difference between a process and a thread?', options: ['No difference', "A process has its own memory space; threads share the memory space of their parent process", 'A thread is a lighter process with its own memory', 'Processes are for OS tasks, threads for user tasks'], correctIndex: 1, explanation: 'Process: independent execution unit with its own address space (heap, stack, code). Thread: lightweight unit within a process, shares heap and code with siblings.', difficulty: 'Easy', xpReward: 50, topic: 'Operating Systems' },
      { id: 'os2', text: 'What is a deadlock?', options: ['A process that runs forever', 'A circular wait where multiple processes each hold a resource the other needs, blocking permanently', "A thread that's sleeping", 'A kernel panic'], correctIndex: 1, explanation: 'Deadlock requires 4 Coffman conditions: mutual exclusion, hold-and-wait, no preemption, circular wait. Prevent by breaking any one condition (e.g., lock ordering, try-lock with timeout).', difficulty: 'Medium', xpReward: 70, topic: 'Operating Systems' },
      { id: 'os3', text: 'What is virtual memory?', options: ['RAM on the cloud', 'An abstraction that gives each process its own contiguous address space, backed by RAM + disk (swap)', "Memory that doesn't exist", 'A faster type of RAM'], correctIndex: 1, explanation: 'Virtual memory: MMU maps virtual addresses to physical RAM. Processes are isolated. Pages can be swapped to disk when RAM is full.', difficulty: 'Medium', xpReward: 70, topic: 'Operating Systems' },
      { id: 'os4', text: 'What is a page fault?', options: ['A hardware error', 'Occurs when a process accesses a page not currently in RAM — OS loads it from disk', 'A file system error', 'An invalid memory access crash'], correctIndex: 1, explanation: 'Page fault: accessed page not in RAM. OS handles it by loading from swap/disk. Too many major faults = thrashing.', difficulty: 'Medium', xpReward: 80, topic: 'Operating Systems' },
      { id: 'os5', text: 'What does a context switch involve?', options: ['Switching between applications', "Saving the current process state (registers, PC, stack pointer) and restoring another process's state", 'Changing the CPU clock speed', 'Switching memory banks'], correctIndex: 1, explanation: 'Context switch: OS saves current process CPU state to PCB, loads next process state. Expensive: cache eviction, TLB flush. Threads cheaper than processes.', difficulty: 'Medium', xpReward: 80, topic: 'Operating Systems' },
      { id: 'os6', text: 'What is a mutex?', options: ['A type of CPU instruction', 'A mutual exclusion lock — only one thread can hold it at a time', 'A shared memory segment', 'A read-only lock'], correctIndex: 1, explanation: 'Mutex: only one thread holds it at a time. Others block until released. Prevents race conditions on shared data.', difficulty: 'Easy', xpReward: 50, topic: 'Operating Systems' },
      { id: 'os7', text: 'What is the difference between preemptive and cooperative scheduling?', options: ['No practical difference', 'Preemptive: OS forcibly interrupts running processes; cooperative: processes voluntarily yield', 'Preemptive is faster', 'Cooperative is used in modern OS'], correctIndex: 1, explanation: 'Preemptive: OS interrupts process after time slice (timer interrupt). Prevents one process from hogging CPU. Cooperative: process runs until it yields — used in older OS.', difficulty: 'Medium', xpReward: 70, topic: 'Operating Systems' },
      { id: 'os8', text: 'What is a system call?', options: ['Calling a function in another process', 'Requesting a privileged OS service (like file I/O, memory allocation) — switches from user mode to kernel mode', 'A network API call', 'A function in libc'], correctIndex: 1, explanation: 'System call: software interrupt that switches CPU to kernel mode. Your code calls read(), write(), malloc() — these translate to sys_read, sys_write. Expensive relative to regular function calls.', difficulty: 'Medium', xpReward: 70, topic: 'Operating Systems' },
      { id: 'os9', text: 'What is the difference between user space and kernel space?', options: ['No difference in modern OS', 'User space: where applications run with limited privileges; kernel space: where OS runs with full hardware access', 'User space is faster', 'Kernel space is only for drivers'], correctIndex: 1, explanation: 'Protection ring: kernel runs in ring 0 (full hardware access). User apps run in ring 3 (restricted). System calls bridge them. Prevents misbehaving apps from crashing the OS.', difficulty: 'Medium', xpReward: 70, topic: 'Operating Systems' },
      { id: 'os10', text: 'What is the purpose of a semaphore?', options: ['A hardware signal', 'A synchronisation primitive with a counter — allows a fixed number of concurrent accesses', 'A networking protocol', 'An OS-level timer'], correctIndex: 1, explanation: 'Semaphore: integer counter. P()/wait() decrements (blocks if 0); V()/signal() increments. Binary semaphore ≈ mutex. Counting semaphore: limit concurrent resource access.', difficulty: 'Hard', xpReward: 90, topic: 'Operating Systems' },
      { id: 'os11', text: 'What is copy-on-write (COW)?', options: ['Duplicating writes to two disks', 'Delaying memory copy until a write occurs — both parent and child process share pages until one writes', 'Writing in a temporary buffer', 'A backup strategy'], correctIndex: 1, explanation: 'COW: after fork(), parent and child share physical memory pages (read-only). On first write, OS copies the affected page. Makes fork() fast even for large processes.', difficulty: 'Hard', xpReward: 100, topic: 'Operating Systems' },
      { id: 'os12', text: 'What is an inode?', options: ['An internet node', 'A data structure storing file metadata (permissions, size, timestamps, disk block locations) — not the filename', 'An in-memory node', 'A type of file descriptor'], correctIndex: 1, explanation: 'Inode: file metadata structure. Contains: owner, permissions, timestamps, size, pointers to data blocks. Filename → inode mapping is in directory entry. Hard links share the same inode.', difficulty: 'Medium', xpReward: 80, topic: 'Operating Systems' },
    ]
  },

  // TYPESCRIPT ADVANCED
  {
    id: 'book_ts_advanced',
    title: 'The Scroll of Strict Types',
    author: 'Anders the Immutable',
    description: "Harness TypeScript's advanced type system to write safer, more expressive code.",
    content: [
      "TypeScript adds static typing to JavaScript, catching errors at compile time.",
      "Advanced types: generics, conditional types, mapped types, template literal types.",
      "The type system is Turing-complete — you can compute types from other types."
    ],
    rewardXp: 700,
    questions: [
      { id: 'ts1', text: 'What is a generic in TypeScript?', options: ['A non-specific function', 'A type parameter that allows a function or type to work with multiple types while maintaining type safety', 'A built-in utility type', 'A type that accepts any value'], correctIndex: 1, explanation: 'Generic <T>: type variable. function identity<T>(x: T): T. Caller determines T. Enables type-safe reuse without sacrificing type information (unlike `any`).', difficulty: 'Easy', xpReward: 50, topic: 'TypeScript Advanced' },
      { id: 'ts2', text: 'What does keyof T produce?', options: ["A list of T's values", "A union of T's property keys as literal types", "The type of T's constructor", "The keys of T at runtime"], correctIndex: 1, explanation: 'keyof T: union of property name literal types. For type Person = {name: string, age: number}, keyof Person = "name" | "age". Essential for type-safe property access and mapped types.', difficulty: 'Medium', xpReward: 70, topic: 'TypeScript Advanced' },
      { id: 'ts3', text: 'What is a conditional type?', options: ['An if/else statement in types', 'T extends U ? X : Y — a type that resolves to X or Y based on a type condition', 'A type that changes at runtime', 'A nullable type'], correctIndex: 1, explanation: 'Conditional type: T extends U ? X : Y. If T is assignable to U, resolves to X, else Y. Foundation of utility types like NonNullable<T>, ReturnType<T>, Parameters<T>.', difficulty: 'Hard', xpReward: 90, topic: 'TypeScript Advanced' },
      { id: 'ts4', text: 'What is infer used for in TypeScript?', options: ['Runtime type inference', 'Capturing a type within a conditional type to use on one branch', 'Inferring function parameter names', 'Automatic type widening'], correctIndex: 1, explanation: 'infer: declare a type variable inside a conditional type. type ReturnType<T> = T extends (...args: any) => infer R ? R : never. Extracts the return type of any function.', difficulty: 'Hard', xpReward: 100, topic: 'TypeScript Advanced' },
      { id: 'ts5', text: 'What is a mapped type?', options: ['A type for Maps', 'A type that transforms each property in another type: { [K in keyof T]: ... }', 'A function that maps over typed arrays', 'A generic collection type'], correctIndex: 1, explanation: 'Mapped type: iterates over keys of T to produce a new type. type Optional<T> = { [K in keyof T]?: T[K] }. Foundation of Partial<T>, Required<T>, Readonly<T>, Record<K,V>.', difficulty: 'Hard', xpReward: 90, topic: 'TypeScript Advanced' },
      { id: 'ts6', text: 'What is the difference between type and interface in TypeScript?', options: ['No difference', 'Interfaces can be extended/merged; types support unions, intersections, and computed types', 'Types are faster to compile', 'Interfaces only work with classes'], correctIndex: 1, explanation: 'Interface: declaration merging, extends. Type alias: unions (A | B), intersections (A & B), conditional, mapped, template literal types. Prefer interface for extensible object shapes, type for everything else.', difficulty: 'Medium', xpReward: 70, topic: 'TypeScript Advanced' },
      { id: 'ts7', text: 'What is never type used for?', options: ['Undefined values', "Unreachable code, exhaustive checking, and types that can't occur", 'Optional values', 'Empty arrays'], correctIndex: 1, explanation: 'never: type of unreachable code. function throws(): never (always throws). In exhaustive switch, default case assigns to never — TypeScript errors if a case is missed.', difficulty: 'Hard', xpReward: 90, topic: 'TypeScript Advanced' },
      { id: 'ts8', text: 'What is a discriminated union?', options: ['A union of different classes', 'A union of types each with a common literal type field used to narrow the type', 'A union with no common types', 'An exclusive OR type'], correctIndex: 1, explanation: 'Discriminated union: type A = { kind: "a", x: number } | { kind: "b", y: string }. The `kind` field narrows the type in switch/if. TypeScript fully narrows each branch.', difficulty: 'Medium', xpReward: 80, topic: 'TypeScript Advanced' },
      { id: 'ts9', text: 'What does the satisfies operator do (TS 4.9+)?', options: ['Validates at runtime', 'Checks that an expression satisfies a type WITHOUT widening the inferred type', 'Makes types optional', 'Asserts type equality'], correctIndex: 1, explanation: "satisfies: const config = { port: 3000 } satisfies Config. TypeScript checks it matches Config but keeps the narrow type (port: 3000, not number). Combines type safety with type inference.", difficulty: 'Hard', xpReward: 100, topic: 'TypeScript Advanced' },
      { id: 'ts10', text: 'What is a template literal type?', options: ['A string interpolation at runtime', 'A type constructed by interpolating other types into a string literal', 'A template for generic types', 'A regex type'], correctIndex: 1, explanation: 'Template literal type: type Greeting = `Hello ${string}`. Combine with unions: type EventName = `on${Capitalize<string>}`. Powerful for type-safe API contracts and event names.', difficulty: 'Hard', xpReward: 100, topic: 'TypeScript Advanced' },
      { id: 'ts11', text: 'What is the as const assertion?', options: ['Type assertion to any', 'Marks an object/array as deeply readonly with literal types instead of widened types', 'Converts to a constant', 'Prevents variable reassignment'], correctIndex: 1, explanation: 'as const: const colours = ["red", "blue"] as const → type is readonly ["red", "blue"], not string[]. Object properties become readonly literals. Essential for creating union types from arrays.', difficulty: 'Medium', xpReward: 70, topic: 'TypeScript Advanced' },
      { id: 'ts12', text: 'What is the purpose of Exclude<T, U>?', options: ['Removes properties from T', 'Creates a type by removing from T all union members assignable to U', 'Prevents using type U with T', 'Filters an array at runtime'], correctIndex: 1, explanation: 'Exclude<T, U>: T extends U ? never : T. For union types. Exclude<"a" | "b" | "c", "a"> = "b" | "c". Opposite of Extract<T, U>. Used with keyof to exclude specific properties.', difficulty: 'Medium', xpReward: 80, topic: 'TypeScript Advanced' },
    ]
  },
];
